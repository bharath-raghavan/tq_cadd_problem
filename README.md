# Non-covalent Analogs of D-Phe-Pro-Arg Chloromethylketone in Thrombin with Structure-based Virtual Screening 

Submission for "Technical Challenge â€“ Computer-Aided Drug Discovery (CADD)" from Terra Quantum AG

by Bharath Raghavan

## Introduction

D-Phe-Pro-Arg chloromethylketone is a known covalent inhibitor of Thrombin. In this work, a short rigid docking-based virtual screening simulation is performed to obtain molecules that non-covalently bind to the same pocket. The Zinc20 database was used, and 250 molecules were selected for screening. From this, the top 10 binders were identified and confirmed to mimic the same non-covalent interactions as D-Phe-Pro-Arg chloromethylketone. Mainly, this is the interaction with the hydrophobic cage formed by Ile174, Trp215, Leu99, His57, Tyr60A and Trp60D (chymotrypsinogen numbering) in Thrombin. Based on ADMET analysis, a "lead score" was calculated, and 5 compounds were suggested for further lead optimization.

Below is the list of 10 compounds with their lead scores:

| SMILES       | Lead Score |
|-------------------------------------------------------|----------|
| `C[C@@H]1Oc2ccccc2O[C@H]1C(=O)N1CCC[C@@H](N2CCNC2=O)C1`	| 0.918034 |
| `O=C(Cc1ccco1)N1CC[C@@]2(C[C@H](Nc3ncccn3)CCO2)C1`	| 0.897855 |
|	`Cc1nc([C@@H]2CCCN(C(=O)CCc3cccnc3)C2)cc(=O)[nH]1`	| 0.896795 |
|	`Cc1ccc(CNC(=O)N[C@@H]2CCCN(c3ncccn3)C2)cn1` | 0.877063 |
|	`Cc1nc(C)n([C@H]2CCCN(C(=O)c3cccc4c[nH]nc34)C2)n1` |	0.845674 |
|	`C[C@@]1(C(=O)N2CCC(c3nc4cc(F)ccc4[nH]3)CC2)CCCCO1`	| 0.844407 |
|	`CO[C@@H](CNc1ncnc(N[C@@H]2CCC[NH2+]C2)n1)c1cccc(C)c1`	| 0.790751 |
|	`Cc1cccc(Nc2nc(N)nc(C[N@@H+]3C[C@@H]4CC(=O)N[C@@H]4C3)n2)c1`	| 0.698908 |
|	`CN(C)c1n[nH]c(-c2cccc(C(=O)NCC[NH+]3CCCCC3)c2)n1` |	0.695348 |
|	`Cc1cccc(Nc2nc(C[N@@H+]3C[C@@H]4CC(=O)N[C@@H]4C3)nc(=N)[nH]2)c1`	| 0.596646 |

## Details

This work consists of 5 steps:

1. Dataset preparation detailed in `dataset_prep/`
2. Virtual screening with Autodock Vina, detailed in `vina/`
3. Investigation of poses generated by DiffDock vs Autodock Vina, detailed in `diffdock`
4. Re-ranking of docked compounds with ADMET metrics, detailed in `admet/`

Details on running the calculations are provided in README files within each directory.

## Usage

The enviorment used to run these calculations can be setup with the `environment.yml` file:

```
conda env create --file environment.yml
```

## Scaling, Logging, and Results Tracking for a Large-Scale CADD Workflow

This work was carried out on a single Macbook, and did not involve any scaling. This severely limited the scope of this work. However, unlike more complicated quantum or MD algorithms, the individual cheminformatics and docking protocols are embarrassingly parallel. For example, the individual data processing steps (like calculating chemical fingerprints, pharmacophore analysis, etc.) can be run on mutiple processes, where each process gets only a small chunk of data. After each time-consuming data processing step is executed, an all gather operation can be performed. The subsequent step is then run. This can be conveniently performed with Python packages like [Dask](https://www.dask.org) (something I have personal experince with). This allows for a client-server setup, where different parts of a Python function can be executed over different clients. Dask also provides functionality to monitor the progress and log results across the different clients using an easy to setup [GUI interface](https://docs.dask.org/en/stable/user-interfaces.html). The virtual screening protocol itself can also be trivially parallelized. It would not require any rewrite of the code; we just need to launch many independent session of the program fed with different batches of dataset, running on different processes. All output files can be written independently, and combined after the simulation completes. Care must be taken to write the output files of each process into dedicated directories, so that different processes do not write to the same file. Helper functions (like those given in `pdbqt.py`) to read the output of Vina should be written. These reading operations can also be wrapped into Dask functions, for scalable result analysis. I am aware of other other data analysis and workflow management tools like KNIME and Snakemake, but do not have experience with them. A more complicated docking simulation for a larger molecule with many rotatable bonds, say with TTConf within TQChem, may be more computationally demanding. In this case, it would benefit from techniques like MPI to parallelize the algorithm itself.
